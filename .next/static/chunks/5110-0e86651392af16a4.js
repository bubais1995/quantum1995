"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5110],{5110:(e,t,o)=>{o.d(t,{A:()=>u,O:()=>c});var s=o(5155),r=o(2115),a=o(63),l=o(7083),i=o(5894);let n=(0,r.createContext)(void 0);function c(e){let{children:t}=e,[o,c]=(0,r.useState)(null),[u,d]=(0,r.useState)(!0),m=(0,a.useRouter)(),{toast:p}=(0,i.dj)(),{followerAccounts:f}=(0,l.F)();(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/auth/session");if(e.ok){let t=await e.json().catch(()=>({}));if((null==t?void 0:t.ok)&&t.user){let e=t.user;try{localStorage.setItem("user",JSON.stringify(e))}catch(e){}c(e),d(!1);return}}}catch(e){}try{let e=localStorage.getItem("user");if(e){let t=JSON.parse(e);c(t),d(!1);return}}catch(e){console.error("Failed to parse user from localStorage",e);try{localStorage.removeItem("user")}catch(e){}}d(!1)})()},[]);let S=async(e,t)=>{let o=null;if("master"===e.toLowerCase()&&"password"===t)o={id:"master",role:"master",name:"Alice Blue Master"};else{let s=f.find(o=>o.username.toLowerCase()===e.toLowerCase()&&o.password===t);s&&(o={id:s.id,role:"follower",name:s.name})}return o?(localStorage.setItem("user",JSON.stringify(o)),c(o),p({title:"Login Successful",description:"Welcome back, ".concat(o.name,"!")}),m.push("/dashboard"),!0):(p({variant:"destructive",title:"Login Failed",description:"Invalid username or password."}),!1)};return(0,s.jsx)(n.Provider,{value:{user:o,loading:u,login:S,logout:()=>{(async()=>{try{await fetch("/api/auth/logout",{method:"POST"})}catch(e){}try{localStorage.removeItem("user")}catch(e){}c(null),p({title:"Logged Out",description:"You have been successfully logged out."}),m.push("/login")})()}},children:t})}function u(){let e=(0,r.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5894:(e,t,o)=>{o.d(t,{dj:()=>d});var s=o(2115);let r=0,a=new Map,l=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);a.set(e,t)},i=[],n={toasts:[]};function c(e){n=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:o}=t;return o?l(o):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===o||void 0===o?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(n,e),i.forEach(e=>{e(n)})}function u(e){let{...t}=e,o=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:o});return c({type:"ADD_TOAST",toast:{...t,id:o,open:!0,onOpenChange:e=>{e||s()}}}),{id:o,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:o}})}}function d(){let[e,t]=s.useState(n);return s.useEffect(()=>(i.push(t),()=>{let e=i.indexOf(t);e>-1&&i.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},7083:(e,t,o)=>{o.d(t,{$:()=>n,F:()=>c});var s=o(5155),r=o(2115);let a=[{id:"ZERODHA-001",name:"Follower One",username:"follower1",password:"password1",clientId:"",apiKey:"",consentGiven:!1,sessionToken:"",initialBalance:1e4,telegramId:"@followerone",riskProfile:"Moderate",lotMultiplier:1,perAccountCap:1e5,dailyLossLimit:5e3,maxExposurePerSymbol:25e3,currentPL:1250.75,status:"Active"},{id:"UPSTOX-002",name:"Follower Two",username:"follower2",password:"password2",clientId:"",apiKey:"",consentGiven:!1,sessionToken:"",initialBalance:25e3,riskProfile:"Aggressive",lotMultiplier:2,perAccountCap:25e4,dailyLossLimit:2e4,maxExposurePerSymbol:75e3,currentPL:-850,status:"Active"},{id:"ANGEL-003",name:"Follower Three",username:"follower3",password:"password3",clientId:"",apiKey:"",consentGiven:!1,sessionToken:"",initialBalance:5e3,riskProfile:"Conservative",lotMultiplier:.5,perAccountCap:5e4,dailyLossLimit:2500,maxExposurePerSymbol:1e4,currentPL:450.2,status:"Paused"}];var l=o(5894);let i=(0,r.createContext)(void 0);function n(e){let{children:t}=e,{toast:o}=(0,l.dj)(),[n,c]=(0,r.useState)(a),[u,d]=(0,r.useState)([]),[m,p]=(0,r.useState)({});(0,r.useEffect)(()=>{try{let e=localStorage.getItem("followerAccounts");e?c(JSON.parse(e)):c(a);let t=localStorage.getItem("followerTrades");t&&p(JSON.parse(t));let o=localStorage.getItem("masterAccounts");o&&d(JSON.parse(o))}catch(e){console.error("Failed to parse from localStorage",e),c(a),p({})}},[]);let f=(e,t)=>{localStorage.setItem("followerAccounts",JSON.stringify(e)),localStorage.setItem("followerTrades",JSON.stringify(t)),localStorage.setItem("masterAccounts",JSON.stringify(u))};return(0,s.jsx)(i.Provider,{value:{followerAccounts:n,masterAccounts:u,followerTrades:m,addAccount:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Follower";if([...n,...u].some(t=>t.id.toLowerCase()===e.id.toLowerCase()))return{success:!1,message:"An account with this ID already exists."};let o=Math.random().toString(36).slice(-8),s=e.name.toLowerCase().replace(/\s/g,"")+Math.floor(10+90*Math.random()),r={id:e.id,name:e.name,username:s,password:o,clientId:e.clientId||"",apiKey:e.apiKey||"",consentGiven:e.consentGiven||!1,sessionToken:e.sessionToken||"",telegramId:e.telegramId,initialBalance:e.initialBalance,riskProfile:"Moderate",lotMultiplier:e.lotMultiplier,perAccountCap:1e5,dailyLossLimit:5e3,maxExposurePerSymbol:25e3,currentPL:0,status:"Active"};if("Master"===t)return d([...u,r]),f(n,m),{success:!0,message:"Master account added.",password:o,username:s};let a=[...n,r];return c(a),f(a,m),{success:!0,message:"Follower added successfully.",password:o,username:s}},removeFollower:e=>{let t=n.filter(t=>t.id!==e);c(t);let s={...m};delete s[e],p(s),f(t,s),o({title:"Account Removed",description:"Account ".concat(e," has been removed.")})},removeMaster:e=>{d(u.filter(t=>t.id!==e)),f(n,m),o({title:"Master Removed",description:"Master ".concat(e," removed.")})},updateFollowerSettings:(e,t)=>{let s=n.map(o=>o.id===e?{...o,...t}:o);c(s),f(s,m),o({title:"Settings Updated",description:"Settings for ".concat(e," have been saved.")})},addFollowerTrade:(e,t)=>{let o={...t,id:"FT".concat(Date.now()),timestamp:new Date().toISOString()},s={...m,[e]:[...m[e]||[],o]};p(s),f(n,s)},removeFollowerTrade:(e,t)=>{let o={...m};Array.isArray(o[e])&&(o[e]=o[e].filter(e=>e.id!==t),p(o),f(n,o))},clearFollowerTrades:e=>{let t={...m};t[e]=[],p(t),f(n,t)}},children:t})}function c(){let e=(0,r.useContext)(i);if(void 0===e)throw Error("useAccount must be used within an AccountProvider");return e}}}]);