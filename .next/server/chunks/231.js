"use strict";exports.id=231,exports.ids=[231],exports.modules={31612:(a,b,c)=>{c.d(b,{q:()=>j});var d=c(21124),e=c(38301),f=c(19518),g=c(74416),h=c(49113);function i({open:a,onOpenChange:b,trade:c}){let{followerAccounts:f}=Object(function(){var a=Error("Cannot find module '@/context/account-context'");throw a.code="MODULE_NOT_FOUND",a}())(),{toast:i}=Object(function(){var a=Error("Cannot find module '@/hooks/use-toast'");throw a.code="MODULE_NOT_FOUND",a}())(),[j,k]=(0,e.useState)(new Set),[l,m]=(0,e.useState)(!1),n=async()=>{if(!c||0===j.size)return void i({title:"Error",description:"Please select at least one follower",variant:"destructive"});m(!0);try{let a=await fetch("/api/trades/copy-selected",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({trade:{id:c.id,symbol:c.symbol,side:"Buy"===c.side?"BUY":"SELL",quantity:c.quantity,price:c.price,order_type:"Market"===c.type?"MARKET":"LIMIT",product_type:"MIS",timestamp:c.timestamp},follower_ids:Array.from(j)})}),d=await a.json();if(!a.ok)throw Error(d.message||"Failed to copy trade");let e=d.summary||{};i({title:"Trade Copied",description:`✅ ${e.successful||0} successful, ⚠️ ${e.skipped||0} skipped, ❌ ${e.failed||0} failed`}),k(new Set),b(!1)}catch(a){console.error("Copy error:",a),i({title:"Error",description:a.message||"Failed to copy trade",variant:"destructive"})}finally{m(!1)}};return c?(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/dialog'");throw a.code="MODULE_NOT_FOUND",a}()),{open:a,onOpenChange:b,children:(0,d.jsxs)(Object(function(){var a=Error("Cannot find module '@/components/ui/dialog'");throw a.code="MODULE_NOT_FOUND",a}()),{className:"sm:max-w-[425px]",children:[(0,d.jsxs)(Object(function(){var a=Error("Cannot find module '@/components/ui/dialog'");throw a.code="MODULE_NOT_FOUND",a}()),{children:[(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/dialog'");throw a.code="MODULE_NOT_FOUND",a}()),{children:"Copy Trade to Followers"}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/dialog'");throw a.code="MODULE_NOT_FOUND",a}()),{children:"Select which followers should receive this trade copy"})]}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("div",{className:"bg-muted p-3 rounded-md space-y-2",children:(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Symbol:"}),(0,d.jsx)("p",{className:"font-medium",children:c.symbol})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Side:"}),(0,d.jsx)("p",{className:`font-medium ${"Buy"===c.side?"text-green-600":"text-red-600"}`,children:c.side})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Quantity:"}),(0,d.jsx)("p",{className:"font-medium",children:c.quantity})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Price:"}),(0,d.jsxs)("p",{className:"font-medium",children:["₹",c.price.toFixed(2)]})]})]})}),(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/label'");throw a.code="MODULE_NOT_FOUND",a}()),{className:"text-base font-semibold",children:"Select Followers"}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/button'");throw a.code="MODULE_NOT_FOUND",a}()),{type:"button",variant:"outline",size:"sm",onClick:()=>{j.size===f.length?k(new Set):k(new Set(f.map(a=>a.id)))},children:j.size===f.length?"Deselect All":"Select All"})]}),0===f.length?(0,d.jsxs)(Object(function(){var a=Error("Cannot find module '@/components/ui/alert'");throw a.code="MODULE_NOT_FOUND",a}()),{children:[(0,d.jsx)(g.A,{className:"h-4 w-4"}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/alert'");throw a.code="MODULE_NOT_FOUND",a}()),{children:"No follower accounts available. Add followers first."})]}):(0,d.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto border rounded-md p-3",children:f.map(a=>(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/checkbox'");throw a.code="MODULE_NOT_FOUND",a}()),{id:a.id,checked:j.has(a.id),onCheckedChange:()=>(a=>{let b=new Set(j);b.has(a)?b.delete(a):b.add(a),k(b)})(a.id),disabled:l}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/label'");throw a.code="MODULE_NOT_FOUND",a}()),{htmlFor:a.id,className:"cursor-pointer flex-1 font-medium",children:a.name||a.id}),(0,d.jsxs)("span",{className:"text-xs text-muted-foreground",children:[a.lotMultiplier,"x"]})]},a.id))})]}),(0,d.jsxs)("div",{className:"text-sm text-muted-foreground",children:[j.size," of ",f.length," selected"]})]}),(0,d.jsxs)(Object(function(){var a=Error("Cannot find module '@/components/ui/dialog'");throw a.code="MODULE_NOT_FOUND",a}()),{children:[(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/button'");throw a.code="MODULE_NOT_FOUND",a}()),{type:"button",variant:"outline",onClick:()=>b(!1),disabled:l,children:"Cancel"}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/button'");throw a.code="MODULE_NOT_FOUND",a}()),{type:"button",onClick:n,disabled:l||0===j.size,children:l?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(h.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Copying..."]}):"Copy to Selected"})]})]})}):null}function j({showAccount:a=!0}){let[b,c]=(0,e.useState)(!0),[g,h]=(0,e.useState)([]),[j,k]=(0,e.useState)(null),[l,m]=(0,e.useState)(null),[n,o]=(0,e.useState)(!1),p=async()=>{c(!0),k(null);try{let a=await fetch("/api/alice/incoming");if(!a.ok)throw Error(`Status ${a.status}`);let b=((await a.json().catch(()=>({}))).trades??[]).map(a=>{let b=a.symbol||a.instrument||a.scrip||"",c=Number(a.quantity??a.qty??0),d=Number(a.price??a.fillPrice??0),e=a.timestamp||new Date().toISOString(),f=a.side||a.buySell||"Buy";return{id:(a.id||`${a.account||"A"}-${b}-${d}-${c}-${f}-${e}`).replace(/\s+/g,""),timestamp:e,account:a.account||a.accountName||"Master",symbol:b,type:a.type||a.product||"Market",side:f,quantity:c,tradedQty:Number(a.tradedQty??a.filledQty??c),price:d,status:a.status||"Filled"}}),c=new Map;for(let a of b)c.set(a.id,a);let d=Array.from(c.values()).sort((a,b)=>new Date(b.timestamp).getTime()-new Date(a.timestamp).getTime());h(d)}catch(a){console.error("Failed to fetch trades",a),k(a?.message??"Failed to fetch")}finally{c(!1)}},q=async()=>{if(confirm("Are you sure you want to delete ALL trades?"))try{let a=await fetch("/api/alice/clear",{method:"DELETE"});(await a.json()).success?h([]):alert("Failed to clear trades")}catch(a){console.error(a),alert("Server error while clearing trades")}};return(0,d.jsxs)("div",{className:"w-full overflow-auto",children:[(0,d.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/button'");throw a.code="MODULE_NOT_FOUND",a}()),{variant:"ghost",size:"sm",onClick:p,children:"Refresh"}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/button'");throw a.code="MODULE_NOT_FOUND",a}()),{variant:"destructive",size:"sm",onClick:q,children:"Clear All"})]})}),b?(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/skeleton'");throw a.code="MODULE_NOT_FOUND",a}()),{className:"h-8 w-full"}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/skeleton'");throw a.code="MODULE_NOT_FOUND",a}()),{className:"h-8 w-full"}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/skeleton'");throw a.code="MODULE_NOT_FOUND",a}()),{className:"h-8 w-full"})]}):j?(0,d.jsxs)("div",{className:"text-sm text-destructive",children:["Error loading trades: ",j]}):(0,d.jsxs)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{children:[(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{children:(0,d.jsxs)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{children:[(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{children:"Time"}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{children:"Side"}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{children:"Instrument"}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{children:"Product"}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{className:"text-right",children:"Qty"}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{className:"text-right",children:"Traded Qty"}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{className:"text-right",children:"Price"}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{className:"text-center",children:"Action"})]})}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{children:0===g.length?(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{children:(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{colSpan:8,className:"h-24 text-center",children:"No trades found."})}):g.map(a=>(0,d.jsxs)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{children:[(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{children:function(a){let b=new Date(a);return isNaN(b.getTime())?"":b.toLocaleTimeString()}(a.timestamp)}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{children:(0,d.jsx)("span",{className:"Buy"===a.side?"inline-block bg-green-100 text-green-800 px-3 py-1 rounded text-sm":"inline-block bg-red-100 text-red-800 px-3 py-1 rounded text-sm",children:a.side})}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{className:"font-medium",children:a.symbol}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{className:"text-sm text-muted-foreground",children:a.type}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{className:"text-right",children:a.quantity}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{className:"text-right",children:a.tradedQty}),(0,d.jsxs)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{className:"text-right",children:["₹",a.price.toFixed(2)]}),(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}()),{className:"text-center",children:(0,d.jsx)(Object(function(){var a=Error("Cannot find module '@/components/ui/button'");throw a.code="MODULE_NOT_FOUND",a}()),{size:"sm",variant:"outline",onClick:()=>{m(a),o(!0)},children:(0,d.jsx)(f.A,{className:"h-4 w-4"})})})]},a.id))})]}),(0,d.jsx)(i,{open:n,onOpenChange:o,trade:l})]})}!function(){var a=Error("Cannot find module '@/components/ui/dialog'");throw a.code="MODULE_NOT_FOUND",a}(),function(){var a=Error("Cannot find module '@/components/ui/button'");throw a.code="MODULE_NOT_FOUND",a}(),function(){var a=Error("Cannot find module '@/components/ui/checkbox'");throw a.code="MODULE_NOT_FOUND",a}(),function(){var a=Error("Cannot find module '@/components/ui/label'");throw a.code="MODULE_NOT_FOUND",a}(),function(){var a=Error("Cannot find module '@/context/account-context'");throw a.code="MODULE_NOT_FOUND",a}(),function(){var a=Error("Cannot find module '@/hooks/use-toast'");throw a.code="MODULE_NOT_FOUND",a}(),function(){var a=Error("Cannot find module '@/components/ui/alert'");throw a.code="MODULE_NOT_FOUND",a}(),function(){var a=Error("Cannot find module '@/components/ui/table'");throw a.code="MODULE_NOT_FOUND",a}(),function(){var a=Error("Cannot find module '@/components/ui/button'");throw a.code="MODULE_NOT_FOUND",a}(),function(){var a=Error("Cannot find module '@/components/ui/skeleton'");throw a.code="MODULE_NOT_FOUND",a}()},49113:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(8808).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},74416:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(8808).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])}};