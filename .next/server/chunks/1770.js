"use strict";exports.id=1770,exports.ids=[1770],exports.modules={49113:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(8808).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},64772:(a,b,c)=>{c.d(b,{Fc:()=>i,TN:()=>j});var d=c(21124),e=c(38301),f=c(26691),g=c(44943);let h=(0,f.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),i=e.forwardRef(({className:a,variant:b,...c},e)=>(0,d.jsx)("div",{ref:e,role:"alert",className:(0,g.cn)(h({variant:b}),a),...c}));i.displayName="Alert",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("h5",{ref:c,className:(0,g.cn)("mb-1 font-medium leading-none tracking-tight",a),...b})).displayName="AlertTitle";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{ref:c,className:(0,g.cn)("text-sm [&_p]:leading-relaxed",a),...b}));j.displayName="AlertDescription"},69390:(a,b,c)=>{c.d(b,{q:()=>N});var d=c(21124),e=c(38301),f=c(79202),g=c(35284),h=c(27081),i=c(19518),j=c(40068),k=c(92808),l=c(2332),m=c(87868),n=c(11720),o=c(10350),p=c(96386),q=c(29988),r=c(99978),s="Checkbox",[t,u]=(0,l.A)(s),[v,w]=t(s),x=e.forwardRef((a,b)=>{let{__scopeCheckbox:c,name:f,checked:g,defaultChecked:h,required:i,disabled:j,value:l="on",onCheckedChange:o,form:p,...q}=a,[s,t]=e.useState(null),u=(0,k.s)(b,a=>t(a)),w=e.useRef(!1),x=!s||p||!!s.closest("form"),[y=!1,z]=(0,n.i)({prop:g,defaultProp:h,onChange:o}),D=e.useRef(y);return e.useEffect(()=>{let a=s?.form;if(a){let b=()=>z(D.current);return a.addEventListener("reset",b),()=>a.removeEventListener("reset",b)}},[s,z]),(0,d.jsxs)(v,{scope:c,state:y,disabled:j,children:[(0,d.jsx)(r.sG.button,{type:"button",role:"checkbox","aria-checked":B(y)?"mixed":y,"aria-required":i,"data-state":C(y),"data-disabled":j?"":void 0,disabled:j,value:l,...q,ref:u,onKeyDown:(0,m.m)(a.onKeyDown,a=>{"Enter"===a.key&&a.preventDefault()}),onClick:(0,m.m)(a.onClick,a=>{z(a=>!!B(a)||!a),x&&(w.current=a.isPropagationStopped(),w.current||a.stopPropagation())})}),x&&(0,d.jsx)(A,{control:s,bubbles:!w.current,name:f,value:l,checked:y,required:i,disabled:j,form:p,style:{transform:"translateX(-100%)"},defaultChecked:!B(h)&&h})]})});x.displayName=s;var y="CheckboxIndicator",z=e.forwardRef((a,b)=>{let{__scopeCheckbox:c,forceMount:e,...f}=a,g=w(y,c);return(0,d.jsx)(q.C,{present:e||B(g.state)||!0===g.state,children:(0,d.jsx)(r.sG.span,{"data-state":C(g.state),"data-disabled":g.disabled?"":void 0,...f,ref:b,style:{pointerEvents:"none",...a.style}})})});z.displayName=y;var A=a=>{let{control:b,checked:c,bubbles:f=!0,defaultChecked:g,...h}=a,i=e.useRef(null),j=(0,o.Z)(c),k=(0,p.X)(b);e.useEffect(()=>{let a=i.current,b=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(j!==c&&b){let d=new Event("click",{bubbles:f});a.indeterminate=B(c),b.call(a,!B(c)&&c),a.dispatchEvent(d)}},[j,c,f]);let l=e.useRef(!B(c)&&c);return(0,d.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:g??l.current,...h,tabIndex:-1,ref:i,style:{...a.style,...k,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function B(a){return"indeterminate"===a}function C(a){return B(a)?"indeterminate":a?"checked":"unchecked"}var D=c(8015),E=c(44943);let F=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(x,{ref:c,className:(0,E.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...b,children:(0,d.jsx)(z,{className:(0,E.cn)("flex items-center justify-center text-current"),children:(0,d.jsx)(D.A,{className:"h-4 w-4"})})}));F.displayName=x.displayName;var G=c(68120),H=c(89081),I=c(37448),J=c(74416),K=c(49113),L=c(64772);function M({open:a,onOpenChange:b,trade:c}){let{followerAccounts:f}=(0,H.F)(),{toast:h}=(0,I.dj)(),[i,k]=(0,e.useState)(new Set),[l,m]=(0,e.useState)(!1),n=async()=>{if(!c||0===i.size)return void h({title:"Error",description:"Please select at least one follower",variant:"destructive"});m(!0);try{let a=await fetch("/api/trades/copy-selected",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({trade:{id:c.id,symbol:c.symbol,side:"Buy"===c.side?"BUY":"SELL",quantity:c.quantity,price:c.price,order_type:"Market"===c.type?"MARKET":"LIMIT",product_type:"MIS",timestamp:c.timestamp},follower_ids:Array.from(i)})}),d=await a.json();if(!a.ok)throw Error(d.message||"Failed to copy trade");let e=d.summary||{};h({title:"Trade Copied",description:`✅ ${e.successful||0} successful, ⚠️ ${e.skipped||0} skipped, ❌ ${e.failed||0} failed`}),k(new Set),b(!1)}catch(a){console.error("Copy error:",a),h({title:"Error",description:a.message||"Failed to copy trade",variant:"destructive"})}finally{m(!1)}};return c?(0,d.jsx)(j.lG,{open:a,onOpenChange:b,children:(0,d.jsxs)(j.Cf,{className:"sm:max-w-[425px]",children:[(0,d.jsxs)(j.c7,{children:[(0,d.jsx)(j.L3,{children:"Copy Trade to Followers"}),(0,d.jsx)(j.rr,{children:"Select which followers should receive this trade copy"})]}),(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsx)("div",{className:"bg-muted p-3 rounded-md space-y-2",children:(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Symbol:"}),(0,d.jsx)("p",{className:"font-medium",children:c.symbol})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Side:"}),(0,d.jsx)("p",{className:`font-medium ${"Buy"===c.side?"text-green-600":"text-red-600"}`,children:c.side})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Quantity:"}),(0,d.jsx)("p",{className:"font-medium",children:c.quantity})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-muted-foreground",children:"Price:"}),(0,d.jsxs)("p",{className:"font-medium",children:["₹",c.price.toFixed(2)]})]})]})}),(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)(G.J,{className:"text-base font-semibold",children:"Select Followers"}),(0,d.jsx)(g.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{i.size===f.length?k(new Set):k(new Set(f.map(a=>a.id)))},children:i.size===f.length?"Deselect All":"Select All"})]}),0===f.length?(0,d.jsxs)(L.Fc,{children:[(0,d.jsx)(J.A,{className:"h-4 w-4"}),(0,d.jsx)(L.TN,{children:"No follower accounts available. Add followers first."})]}):(0,d.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto border rounded-md p-3",children:f.map(a=>(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)(F,{id:a.id,checked:i.has(a.id),onCheckedChange:()=>(a=>{let b=new Set(i);b.has(a)?b.delete(a):b.add(a),k(b)})(a.id),disabled:l}),(0,d.jsx)(G.J,{htmlFor:a.id,className:"cursor-pointer flex-1 font-medium",children:a.name||a.id}),(0,d.jsxs)("span",{className:"text-xs text-muted-foreground",children:[a.lotMultiplier,"x"]})]},a.id))})]}),(0,d.jsxs)("div",{className:"text-sm text-muted-foreground",children:[i.size," of ",f.length," selected"]})]}),(0,d.jsxs)(j.Es,{children:[(0,d.jsx)(g.$,{type:"button",variant:"outline",onClick:()=>b(!1),disabled:l,children:"Cancel"}),(0,d.jsx)(g.$,{type:"button",onClick:n,disabled:l||0===i.size,children:l?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(K.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Copying..."]}):"Copy to Selected"})]})]})}):null}function N({showAccount:a=!0}){let[b,c]=(0,e.useState)(!0),[j,k]=(0,e.useState)([]),[l,m]=(0,e.useState)(null),[n,o]=(0,e.useState)(null),[p,q]=(0,e.useState)(!1),r=async()=>{c(!0),m(null);try{let a=await fetch("/api/alice/trades");if(!a.ok)throw Error(`Status ${a.status}`);let b=((await a.json().catch(()=>({}))).trades??[]).map(a=>{let b=a.symbol||a.instrument||a.scrip||"",c=Number(a.quantity??a.qty??0),d=Number(a.price??a.fillPrice??0),e=a.timestamp||new Date().toISOString(),f=a.side||a.buySell||"Buy";return{id:(a.id||`${a.account||"A"}-${b}-${d}-${c}-${f}-${e}`).replace(/\s+/g,""),timestamp:e,account:a.account||a.accountName||"Master",symbol:b,type:a.type||a.product||"Market",side:f,quantity:c,tradedQty:Number(a.tradedQty??a.filledQty??c),price:d,status:a.status||"Filled"}}),c=new Map;for(let a of b)c.set(a.id,a);let d=Array.from(c.values()).sort((a,b)=>new Date(b.timestamp).getTime()-new Date(a.timestamp).getTime());k(d)}catch(a){console.error("Failed to fetch trades",a),m(a?.message??"Failed to fetch")}finally{c(!1)}};return(0,d.jsxs)("div",{className:"w-full overflow-auto",children:[(0,d.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,d.jsx)("div",{className:"flex gap-2",children:(0,d.jsx)(g.$,{variant:"ghost",size:"sm",onClick:r,children:"Refresh"})})}),b?(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)(h.E,{className:"h-8 w-full"}),(0,d.jsx)(h.E,{className:"h-8 w-full"}),(0,d.jsx)(h.E,{className:"h-8 w-full"})]}):l?(0,d.jsxs)("div",{className:"text-sm text-destructive",children:["Error loading trades: ",l]}):(0,d.jsxs)(f.XI,{children:[(0,d.jsx)(f.A0,{children:(0,d.jsxs)(f.Hj,{children:[(0,d.jsx)(f.nd,{children:"Time"}),(0,d.jsx)(f.nd,{children:"Side"}),(0,d.jsx)(f.nd,{children:"Instrument"}),(0,d.jsx)(f.nd,{children:"Product"}),(0,d.jsx)(f.nd,{className:"text-right",children:"Qty"}),(0,d.jsx)(f.nd,{className:"text-right",children:"Traded Qty"}),(0,d.jsx)(f.nd,{className:"text-right",children:"Price"}),(0,d.jsx)(f.nd,{className:"text-center",children:"Action"})]})}),(0,d.jsx)(f.BF,{children:0===j.length?(0,d.jsx)(f.Hj,{children:(0,d.jsx)(f.nA,{colSpan:8,className:"h-24 text-center",children:"No trades found."})}):j.map(a=>(0,d.jsxs)(f.Hj,{children:[(0,d.jsx)(f.nA,{children:function(a){let b=new Date(a);return isNaN(b.getTime())?"":b.toLocaleTimeString()}(a.timestamp)}),(0,d.jsx)(f.nA,{children:(0,d.jsx)("span",{className:"Buy"===a.side?"inline-block bg-green-100 text-green-800 px-3 py-1 rounded text-sm":"inline-block bg-red-100 text-red-800 px-3 py-1 rounded text-sm",children:a.side})}),(0,d.jsx)(f.nA,{className:"font-medium",children:a.symbol}),(0,d.jsx)(f.nA,{className:"text-sm text-muted-foreground",children:a.type}),(0,d.jsx)(f.nA,{className:"text-right",children:a.quantity}),(0,d.jsx)(f.nA,{className:"text-right",children:a.tradedQty}),(0,d.jsxs)(f.nA,{className:"text-right",children:["₹",a.price.toFixed(2)]}),(0,d.jsx)(f.nA,{className:"text-center",children:(0,d.jsx)(g.$,{size:"sm",variant:"outline",onClick:()=>{o(a),q(!0)},children:(0,d.jsx)(i.A,{className:"h-4 w-4"})})})]},a.id))})]}),(0,d.jsx)(M,{open:p,onOpenChange:q,trade:n})]})}},74416:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(8808).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},79202:(a,b,c)=>{c.d(b,{A0:()=>h,BF:()=>i,Hj:()=>j,XI:()=>g,nA:()=>l,nd:()=>k});var d=c(21124),e=c(38301),f=c(44943);let g=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("div",{className:"relative w-full overflow-auto",children:(0,d.jsx)("table",{ref:c,className:(0,f.cn)("w-full caption-bottom text-sm",a),...b})}));g.displayName="Table";let h=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("thead",{ref:c,className:(0,f.cn)("[&_tr]:border-b",a),...b}));h.displayName="TableHeader";let i=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("tbody",{ref:c,className:(0,f.cn)("[&_tr:last-child]:border-0",a),...b}));i.displayName="TableBody",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("tfoot",{ref:c,className:(0,f.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...b})).displayName="TableFooter";let j=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("tr",{ref:c,className:(0,f.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...b}));j.displayName="TableRow";let k=e.forwardRef(({className:a,classNameName:b,...c},e)=>(0,d.jsx)("th",{ref:e,className:(0,f.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...c}));k.displayName="TableHead";let l=e.forwardRef(({className:a,classNameName:b,...c},e)=>(0,d.jsx)("td",{ref:e,className:(0,f.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...c}));l.displayName="TableCell",e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("caption",{ref:c,className:(0,f.cn)("mt-4 text-sm text-muted-foreground",a),...b})).displayName="TableCaption"},99187:(a,b,c)=>{c.d(b,{E:()=>h});var d=c(21124);c(38301);var e=c(26691),f=c(44943);let g=(0,e.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function h({className:a,variant:b,...c}){return(0,d.jsx)("div",{className:(0,f.cn)(g({variant:b}),a),...c})}}};